<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.yedam.gamerz.community.post.mapper.PostMapper">

<select id="postSelectList" resultType="co.yedam.gamerz.community.post.service.PostVO">
	SELECT * FROM COMMUNITY ORDER BY POST_ID DESC
</select>

<select id="postSearchtList" resultType="co.yedam.gamerz.community.post.service.PostVO">
	SELECT * FROM COMMUNITY WHERE
	<if test="key == 'title'">POST_TITLE LIKE '%'||#{val}||'%'</if>
	<if test="key == 'subject'">POST_SUBJECT LIKE '%'||#{val}||'%'</if>
	<if test="key == 'writer'">POST_WRITER LIKE '%'||#{val}||'%'</if>
	ORDER BY POST_ID DESC
</select>

<select id="postSelect" resultType="co.yedam.gamerz.community.post.service.PostVO">
	SELECT * FROM COMMUNITY WHERE POST_ID = #{postId}
</select>

<insert id="postInsert" parameterType="co.yedam.gamerz.community.post.service.PostVO">
	INSERT INTO COMMUNITY(POST_TITLE, POST_SUBJECT,POST_ATTACH,POST_ATTACH_DIR,POST_WRITER,POST_WRITER_ID, POST_HIT)
	VALUES(#{postTitle},#{postSubject},#{postAttach},#{postAttachDir},#{postWriter},#{postWriterId},0)
</insert>

<update id="postUpdate" parameterType="co.yedam.gamerz.community.post.service.PostVO">
	UPDATE COMMUNITY
	<set>
		<if test="postTitle != null">POST_TITLE = #{postTitle}</if>	
		<if test="postSubject != null">POST_SUBJECT = #{postSubject}</if>
		<if test="postAttach != null">POST_ATTACH = #{postAttach}</if>
		<if test="postAttachDir != null">POST_ATTACH_DIR = #{postAttachDir}</if>
		<if test="postUpdateDate != null">POST_UPDATE_DATE = #{postUpdateDate}</if>  
	</set>
	WHERE POST_ID = #{postId}
</update>

<delete id="postDelete" parameterType="co.yedam.gamerz.community.post.service.PostVO">
	DELETE COMMUNITY WHERE POST_ID = #{postId}
</delete>

<update id="postUpdateHit" parameterType="int">
	UPDATE COMMUNITY SET POST_HIT = POST_HIT + 1 WHERE POST_ID = #{postId}
</update>
</mapper>